<!DOCTYPE html>
<html>
<style>
table,th,td {
  border : 1px solid black;
  border-collapse: collapse;
}
th,td {
  padding: 5px;
}
</style>
<body>

<p>Languages by popularity.</p>
<form action=""> 
Filter: <input type="text" id="txt1" onkeyup="filterList()">
</form>
<p id='details'></p>
<table id="demo"></table>

<script>
'use strict';
var x, tags;
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    var xmlDoc = xhttp.responseXML;
    x = xmlDoc.getElementsByTagName("LANG");
    tags = [];
    var i;
    for (i = 0; i <x.length; i++) { 
      tags[i] = i;
    }
    filterList();
  }
};
xhttp.open("GET", "RC_POP.XML", true);
xhttp.send();

function filterList() {
  var input, filter, table, i;
  input = document.getElementById("txt1");
  filter = input.value.toLowerCase();
  var table="<tr><th onclick='sortTable(0)'>Rank</th>" +
                "<th onclick='sortTable(1)'>Name</th>" +
                "<th onclick='sortTable(2)'>Entries</th></tr>";
  for (i = 0; i <x.length; i++) { 
    var ti = tags[i]
    var lang = x[ti].getElementsByTagName("NAME")[0].childNodes[0].nodeValue;
    if (filter.length==0 || lang.toLowerCase().indexOf(filter)!=-1) {
      table += "<tr onclick='displayDetails(" + i + ")'><td>" +
      x[ti].getElementsByTagName("RANK")[0].childNodes[0].nodeValue +
      "</td><td>" +
      lang +
      "</td><td>" +
      x[ti].getElementsByTagName("ENTRIES")[0].childNodes[0].nodeValue +
      "</td></tr>";
    }
  }
  document.getElementById("demo").innerHTML = table;
}

var sorttag = "RANK";
function xSorter(i, j) {
  var ti = x[i].getElementsByTagName(sorttag)[0].childNodes[0].nodeValue;
  var tj = x[j].getElementsByTagName(sorttag)[0].childNodes[0].nodeValue;
  return ti < tj ? -1 : ti > tj ? 1 : 0;
}

function sortTable(sortcol) {
  sorttag = ["RANK","NAME","ENTRIES"][sortcol];
  tags.sort(xSorter);
  filterList();
}

function displayDetails(i) {
  var ti = tags[i];
  document.getElementById("details").innerHTML =
  "Rank: " +
  x[ti].getElementsByTagName("RANK")[0].childNodes[0].nodeValue +
  "<br>Name: " +
  x[ti].getElementsByTagName("NAME")[0].childNodes[0].nodeValue +
  "<br>Entries: " + 
  x[ti].getElementsByTagName("ENTRIES")[0].childNodes[0].nodeValue;
}
</script>

</body>
</html>

